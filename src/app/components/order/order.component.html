<div class="order-container">
  <div class="back-button-container">
    <a routerLink="/" class="back-button">
      <span class="back-icon">←</span>
      Back
    </a>
  </div>

  <h1>
    Order your meals
    <span>A unique gastronomic experience</span>
  </h1>
  
  <form [formGroup]="orderForm" (ngSubmit)="onSubmit()" class="order-form">
    <div class="form-section personal-info" formGroupName="personalInfo">
      <h2>Personal Information</h2>
      
      <div class="form-row">
        <div class="form-group">
          <label for="lastName">Last Name *</label>
          <input id="lastName" type="text" formControlName="lastName" placeholder="Your last name">
          <div class="error-message" *ngIf="orderForm.get('personalInfo.lastName')?.errors?.['required'] && orderForm.get('personalInfo.lastName')?.touched">
            Last name is required
          </div>
        </div>

        <div class="form-group">
          <label for="firstName">First Name *</label>
          <input id="firstName" type="text" formControlName="firstName" placeholder="Your first name">
          <div class="error-message" *ngIf="orderForm.get('personalInfo.firstName')?.errors?.['required'] && orderForm.get('personalInfo.firstName')?.touched">
            First name is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="email">Email *</label>
          <input id="email" type="email" formControlName="email" placeholder="your@email.com">
          <div class="error-message" *ngIf="orderForm.get('personalInfo.email')?.errors?.['required'] && orderForm.get('personalInfo.email')?.touched">
            Email is required
          </div>
          <div class="error-message" *ngIf="orderForm.get('personalInfo.email')?.errors?.['email'] && orderForm.get('personalInfo.email')?.touched">
            Email is not valid
          </div>
        </div>

        <div class="form-group">
          <label for="phone">Phone *</label>
          <input id="phone" type="tel" formControlName="phone" placeholder="Your phone number">
          <div class="error-message" *ngIf="orderForm.get('personalInfo.phone')?.errors?.['required'] && orderForm.get('personalInfo.phone')?.touched">
            Phone number is required
          </div>
          <div class="error-message" *ngIf="orderForm.get('personalInfo.phone')?.errors?.['pattern'] && orderForm.get('personalInfo.phone')?.touched">
            Phone number format is not valid
          </div>
        </div>
      </div>
    </div>

    <div class="form-section address-info" formGroupName="address">
      <h2>Delivery Address</h2>
      
      <div class="form-group full-width">
        <label for="street">Address *</label>
        <input id="street" type="text" formControlName="street" placeholder="Your address">
        <div class="error-message" *ngIf="orderForm.get('address.street')?.errors?.['required'] && orderForm.get('address.street')?.touched">
          Address is required
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="postalCode">Postal Code *</label>
          <input id="postalCode" type="text" formControlName="postalCode" placeholder="Postal code">
          <div class="error-message" *ngIf="orderForm.get('address.postalCode')?.errors?.['required'] && orderForm.get('address.postalCode')?.touched">
            Postal code is required
          </div>
          <div class="error-message" *ngIf="orderForm.get('address.postalCode')?.errors?.['pattern'] && orderForm.get('address.postalCode')?.touched">
            Postal code must contain 5 digits
          </div>
        </div>

        <div class="form-group">
          <label for="city">City *</label>
          <input id="city" type="text" formControlName="city" placeholder="City">
          <div class="error-message" *ngIf="orderForm.get('address.city')?.errors?.['required'] && orderForm.get('address.city')?.touched">
            City is required
          </div>
        </div>
      </div>
    </div>

    <div class="form-section menu-selection" formGroupName="menuSelection">
      <h2>Menu Selection</h2>
      <p class="section-description">Select the days you want to be delivered</p>
      
      <div class="menu-grid">
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="monday">
            <span class="checkmark"></span>
            Monday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="tuesday">
            <span class="checkmark"></span>
            Tuesday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="wednesday">
            <span class="checkmark"></span>
            Wednesday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="thursday">
            <span class="checkmark"></span>
            Thursday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="friday">
            <span class="checkmark"></span>
            Friday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="saturday">
            <span class="checkmark"></span>
            Saturday
          </label>
        </div>
        <div class="menu-day">
          <label class="checkbox-container">
            <input type="checkbox" formControlName="sunday">
            <span class="checkmark"></span>
            Sunday
          </label>
        </div>
      </div>
    </div>

    <!-- Section des préférences culinaires -->
    <div class="form-section" formGroupName="preferences">
      <h2>Culinary Preferences</h2>
      <div class="form-row">
        <div class="form-group">
          <label for="budget">Monthly meal budget</label>
          <select id="budget" formControlName="budget" class="form-control">
            <option value="">Select your budget</option>
            <option value="low">Less than 500€</option>
            <option value="medium">500€ - 1000€</option>
            <option value="high">More than 1000€</option>
          </select>
          <div class="error-message" *ngIf="orderForm.get('preferences.budget')?.errors?.['required'] && orderForm.get('preferences.budget')?.touched">
            Budget is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Do you use delivery platforms?</label>
          <div class="checkbox-group">
            <div class="checkbox-container">
              <input type="checkbox" id="deliveroo" formControlName="deliveroo">
              <label for="deliveroo">Deliveroo</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="ubereats" formControlName="ubereats">
              <label for="ubereats">Uber Eats</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="justeat" formControlName="justeat">
              <label for="justeat">Just Eat</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="other" formControlName="otherDelivery">
              <label for="other">Other</label>
            </div>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="restaurantFrequency">How often do you eat out?</label>
          <select id="restaurantFrequency" formControlName="restaurantFrequency" class="form-control">
            <option value="">Select frequency</option>
            <option value="never">Never</option>
            <option value="rarely">Rarely (1-2 times/month)</option>
            <option value="sometimes">Sometimes (1-2 times/week)</option>
            <option value="often">Often (3-4 times/week)</option>
            <option value="veryOften">Very often (5+ times/week)</option>
          </select>
          <div class="error-message" *ngIf="orderForm.get('preferences.restaurantFrequency')?.errors?.['required'] && orderForm.get('preferences.restaurantFrequency')?.touched">
            Restaurant frequency is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Preferred food types</label>
          <div class="checkbox-group">
            <div class="checkbox-container">
              <input type="checkbox" id="french" [formControl]="favoriteFoodControl" value="french">
              <label for="french">French cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="italian" [formControl]="favoriteFoodControl" value="italian">
              <label for="italian">Italian cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="japanese" [formControl]="favoriteFoodControl" value="japanese">
              <label for="japanese">Japanese cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="chinese" [formControl]="favoriteFoodControl" value="chinese">
              <label for="chinese">Chinese cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="indian" [formControl]="favoriteFoodControl" value="indian">
              <label for="indian">Indian cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="mexican" [formControl]="favoriteFoodControl" value="mexican">
              <label for="mexican">Mexican cuisine</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="vegetarian" [formControl]="favoriteFoodControl" value="vegetarian">
              <label for="vegetarian">Vegetarian</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="vegan" [formControl]="favoriteFoodControl" value="vegan">
              <label for="vegan">Vegan</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="seafood" [formControl]="favoriteFoodControl" value="seafood">
              <label for="seafood">Seafood</label>
            </div>
            <div class="checkbox-container">
              <input type="checkbox" id="meat" [formControl]="favoriteFoodControl" value="meat">
              <label for="meat">Meat</label>
            </div>
          </div>
          <div class="error-message" *ngIf="orderForm.get('preferences.favoriteFood')?.errors?.['required'] && orderForm.get('preferences.favoriteFood')?.touched">
            Please select at least one preferred food type
          </div>
        </div>
      </div>
    </div>

    <!-- Section des commentaires et découverte -->
    <div class="form-section">
      <h2>Additional Information</h2>
      
      <div class="form-row" formGroupName="preferences">
        <div class="form-group">
          <label for="discovery">How did you hear about our service?</label>
          <select id="discovery" formControlName="discovery" class="form-control">
            <option value="">Select an option</option>
            <option value="google">Google</option>
            <option value="social">Social media</option>
            <option value="friend">Friend recommendation</option>
            <option value="advertisement">Advertisement</option>
            <option value="other">Other</option>
          </select>
          <div class="error-message" *ngIf="orderForm.get('preferences.discovery')?.errors?.['required'] && orderForm.get('preferences.discovery')?.touched">
            Please indicate how you heard about our service
          </div>
        </div>
      </div>

      <div class="form-group full-width">
        <label for="comments">Comments</label>
        <textarea id="comments" formControlName="comments" rows="4" placeholder="Comments or special instructions"></textarea>
      </div>
    </div>

    <div class="form-actions">
      <div *ngIf="formErrors.length > 0" class="form-errors-summary">
        <p class="error-title">Please correct the following errors:</p>
        <ul>
          <li *ngFor="let error of formErrors">{{ error }}</li>
        </ul>
      </div>
      
      <button type="submit" 
              class="submit-button" 
              [class.loading]="isSubmitting"
              [disabled]="isSubmitting">
        <div class="button-content">
          <div *ngIf="isSubmitting" class="spinner-container">
            <div class="spinner">
              <div class="bubble"></div>
              <div class="bubble"></div>
              <div class="bubble"></div>
            </div>
          </div>
          <span>{{ isSubmitting ? 'Processing...' : 'Submit order' }}</span>
        </div>
      </button>
    </div>
  </form>
</div> 